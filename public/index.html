<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scan Soal AI</title>
<style>
body{font-family:sans-serif;margin:10px;padding:0} 
h2{margin-top:20px} 
button,input,select{margin:5px 0;padding:8px;width:100%;max-width:400px;box-sizing:border-box}
textarea{width:100%;max-width:400px;height:150px;margin-top:5px}
.review-box{border:1px solid #ccc;padding:10px;margin-top:10px}
</style>
</head>
<body>
<h2>Scan Soal AI</h2>

<label>Ambil Gambar / File:</label>
<input type="file" id="fileInput" accept="image/*" capture="camera">

<label>Jumlah Pilihan Ganda:</label>
<input type="number" id="pgCount" value="2">

<label>Jumlah Essay:</label>
<input type="number" id="essayCount" value="2">

<button id="processBtn">Proses Soal</button>

<h2>Preview Soal</h2>
<div class="review-box" id="reviewBox"></div>

<button id="printBtn">Print Langsung</button>
<button id="wordBtn">Export Word</button>

<script>
const fileInput = document.getElementById("fileInput");
const processBtn = document.getElementById("processBtn");
const reviewBox = document.getElementById("reviewBox");
const printBtn = document.getElementById("printBtn");
const wordBtn = document.getElementById("wordBtn");
const pgInput = document.getElementById("pgCount");
const essayInput = document.getElementById("essayCount");

processBtn.onclick = async ()=>{
  if(!fileInput.files[0]) return alert("Pilih file dulu");
  const formData = new FormData();
  formData.append("file", fileInput.files[0]);
  formData.append("pg", pgInput.value);
  formData.append("essay", essayInput.value);

  const res = await fetch("/process", { method:"POST", body:formData });
  const data = await res.json();
  reviewBox.innerHTML="";
  if(data.pg) data.pg.forEach((q,i)=>reviewBox.innerHTML+=`<b>PG ${i+1}:</b> ${q.pertanyaan} <br><i>Jawaban: ${q.jawaban}</i><br>`);
  if(data.essay) data.essay.forEach((q,i)=>reviewBox.innerHTML+=`<b>Essay ${i+1}:</b> ${q.pertanyaan} <br><i>Jawaban: ${q.jawaban}</i><br>`);
};

printBtn.onclick = ()=>{ window.print(); }
wordBtn.onclick = ()=>{ window.location="/export-word"; }
</script>
</body>
</html>
