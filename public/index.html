<!DOCTYPE html>
<html>
<body>

<h2>Scan Soal AI</h2>

<input type="file" id="file">
<button onclick="upload()">Proses</button>

<pre id="soal"></pre>

<button onclick="exportWord()">Export Word</button>
<button onclick="window.print()">Print</button>

<script>
async function upload(){
  const fd=new FormData();
  fd.append("image",file.files[0]);
  const r=await fetch("/upload",{method:"POST",body:fd});
  const j=await r.json();
  soal.textContent=j.ai;
}

async function exportWord(){
  await fetch("/export",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({soal:soal.textContent})
  }).then(r=>r.blob()).then(b=>{
    const a=document.createElement("a");
    a.href=URL.createObjectURL(b);
    a.download="soal.docx";
    a.click();
  });
}
</script>

</body>
</html>
