<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scan Soal AI</title>
<style>
body { font-family: Arial,sans-serif; padding:20px; background:#f4f4f4;}
h1{text-align:center;color:#333;}
.container{max-width:600px;margin:auto;background:#fff;padding:20px;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.1);}
input,button{margin-top:10px;width:100%;padding:10px;font-size:16px;border-radius:4px;border:1px solid #ccc;}
button{cursor:pointer;background:#4CAF50;color:#fff;border:none;}
button:hover{background:#45a049;}
#soal,#jawaban{margin-top:20px;padding:10px;background:#e8f0fe;border-radius:4px;white-space:pre-wrap;}
.tips{font-size:14px;color:#555;margin-top:10px;}
</style>
</head>
<body>
<h1>Scan Soal & Jawaban AI</h1>
<div class="container">
<p class="tips">Tips: Foto terang, kertas lurus, fokus ke soal, hindari bayangan tangan/HP.</p>
<label>Pilih File (max 5 gambar)</label>
<input type="file" id="fileInput" multiple accept="image/*">
<label>Ambil Foto Langsung</label>
<input type="file" id="cameraInput" multiple accept="image/*" capture="environment">
<button id="processBtn">Proses</button>

<div id="soal"><strong>SOAL Preview:</strong></div>
<div id="jawaban"><strong>JAWABAN Preview:</strong></div>

<button id="downloadBtn" style="background:#2196F3;">Download Word</button>
<button id="printBtn" style="background:#FF9800;">Print</button>
</div>

<script>
const processBtn = document.getElementById("processBtn");
const fileInput = document.getElementById("fileInput");
const cameraInput = document.getElementById("cameraInput");
const soalDiv = document.getElementById("soal");
const jawabanDiv = document.getElementById("jawaban");
const downloadBtn = document.getElementById("downloadBtn");
const printBtn = document.getElementById("printBtn");

processBtn.onclick = async () => {
  const files = [...fileInput.files, ...cameraInput.files];
  if(files.length===0){alert("Pilih minimal 1 gambar"); return;}
  const formData = new FormData();
  files.forEach(f=>formData.append("images",f));
  soalDiv.textContent="Loading OCR & AI...";
  jawabanDiv.textContent="";
  const res = await fetch("/upload",{method:"POST",body:formData});
  const data = await res.json();
  if(data.error){soalDiv.textContent=data.error; jawabanDiv.textContent=""; return;}
  soalDiv.textContent=data.aiResult.soalPG+"\n"+data.aiResult.soalEssay;
  jawabanDiv.textContent=data.aiResult.jawabanPG+"\n"+data.aiResult.jawabanEssay;
};

downloadBtn.onclick = ()=>{window.location="/download";};
printBtn.onclick = ()=>{window.print();};
</script>
</body>
</html>
